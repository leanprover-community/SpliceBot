
name: Log PR Comment JSON

on:
  # the PR receives a comment
  #issue_comment:
  #  types: [created, edited]
  # the PR receives a review
  #pull_request_review:
  #  # whether or not it is accompanied by a comment
  #  types: [submitted]
  # the PR receives a review comment
  pull_request_review_comment:
    types: [created, edited]

jobs:
  log-comment-json:
    runs-on: ubuntu-latest
    steps:
      - name: Log the event payload
        run: |
          echo "Logging the JSON payload for the pull request comment..."
          echo '${{ toJson(github.event) }}'

      - name: Extract file path & filename from review comment
        id: extract
        uses: actions/github-script@v7
        with:
          script: |
            // The path to the file where the suggestion / review comment is located
            const path = context.payload?.comment?.path;
            if (!path) {
              core.setFailed("No file path found on this review comment payload.");
              return;
            }

            // Derive just the filename from the path
            const filename = path.split('/').pop();

            core.info(`Found file path: ${path}`);
            core.info(`Filename: ${filename}`);

            core.setOutput('file_path', path);
            core.setOutput('file_name', filename);
      - name: Example use of outputs
        run: |
          echo "File path: ${{ steps.extract.outputs.file_path }}"
          echo "File name: ${{ steps.extract.outputs.file_name }}"
